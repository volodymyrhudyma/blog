---
title: "Warning: Can't perform a React state update on an unmounted component"
tag:
  - React
promote: false
metaDescription: // META
teaser: // TEASER
date: 2020-12-02T15:50:00.000Z
---
"**Can't perform a React state update on an unmounted component**" - is one of the most popular warnings I React developers face.

I am one hundred percent sure that each developer encountered this at least once and did not know why that appeared and how to get rid of it.

To begin with, this warning is not something critical and seeing this does not necessarily mean that your application is not working as expected, but for sure the warning should not be omitted.

The warning notifies you that you tried to set the state of the component that has already been unmounted.

## What Happens If I Omit It?

The short answer is - it depends. It may or may not have a huge impact on the performance of React applications.

Let's assume that this warning is generated by the asynchronous call that waits for the completion and sets the local state of the component:

```tsx
const User = () => {
  const [user, setUser] = useState<User | null>(null);

  useEffect(() => {
    setTimeout(() => {
      // The warning is generated by this code
      // If the component unmounts faster than 3s
      setUser({
        id: 1,
        name: "John",
      });
    }, 3000);
  }, []);

  return <div>{user?.name || "No user found"}</div>;
};

```

If only one component missed handling the case of not setting the state after being unmounted, it has almost no impact on the performance.

But if there are a lot of such components (for example, a list) and all of them are not correctly implemented, the impact is huge and the application will be slowed down noticeably.

## Simple Example

A simple example is worth a thousand words, so let's create a simple React application that throws the warning (I will skip all the styles, imports and exports for better readability).

**App.tsx:**

```tsx
const App = () => {
  const [activeView, setActiveView] = useState('project');

  const toggleUser = () => {
    setActiveView('user');
  };

  const toggleProject = () => {
    setActiveView('project');
  };

  return (
    <Wrapper>
      <Button onClick={toggleProject}>Show project</Button>
      <Button onClick={toggleUser}>Show user</Button>
      {activeView === 'user' ? <User /> : <Project />}
    </Wrapper>
  );
};
```

**User.tsx:**

```tsx
const User = () => {
  const [user, setUser] = useState<User | null>(null);

  useEffect(() => {
    setTimeout(() => {
      // The warning is generated by this code
      // If the component unmounts faster than 3s
      setUser({
        id: 1,
        name: "John",
      });
    }, 3000);
  }, []);

  return <div>{user?.name || "No user found"}</div>;
};
```

**Project.tsx:**

```tsx
const Project = () => <div>Project component</div>;

```

The working app looks the following way:

![Working React Application](/img/screenshot-2020-12-01-at-20.01.04.png "Working React Application")

Those buttons at the top act like the tabs, clicking on the first one shown the **Project** component, on the second one - the **User**.

Now open the developers console and click on the "**Show user**" button and then quickly back on the "**Show project**":

![React Application With Warning](/img/ezgif.com-gif-maker-3-.gif "React Application With Warning")

## Fixing an Example

## Summary